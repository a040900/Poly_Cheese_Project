# ğŸ§€ ä¹³é…ªã®BTCé æ¸¬å®¤ å°ˆæ¡ˆé€²åº¦è¨˜éŒ„

**æœ€å¾Œæ›´æ–°**: 2026-02-18 11:47 (å°ç£æ™‚é–“)  
**å°ˆæ¡ˆç‰ˆæœ¬**: 2.1.0  
**ç•¶å‰éšæ®µ**: Phase 2.1 åˆ©æ½¤éæ¿¾å™¨å·²å®Œæˆ âœ… â€” æº–å‚™é€²å…¥ Phase 3  

---

## ğŸ“ ç•¶å‰ç‹€æ…‹

### âœ… Phase 1 å·²å®Œæˆ (v1.0.0)
- **æ•¸æ“šç²å–**: Binance WebSocket/REST, Polymarket WebSocket/REST, Chainlink éˆä¸Šåƒ¹æ ¼
- **æŒ‡æ¨™ç³»çµ±**: 9 ç¨®æŠ€è¡“æŒ‡æ¨™ (EMA, OBI, MACD, CVD, HA, VWAP, RSI, POC, Walls)
- **ä¿¡è™Ÿå¼•æ“**: ç¶œåˆè¶¨å‹¢è©•åˆ†ç³»çµ±ï¼Œæ”¯æ´ 3 ç¨®äº¤æ˜“æ¨¡å¼ (ç©æ¥µ/å¹³è¡¡/ä¿å®ˆ)
- **æ¨¡æ“¬äº¤æ˜“**: è™›æ“¬å¸³æˆ¶ã€è‡ªå‹•çµç®—ã€PnL è¿½è¹¤
- **Web Dashboard**: å¯¦æ™‚æ•¸æ“šæ¨æ’­ã€æ˜æš—ä¸»é¡Œã€äº¤æ˜“è¨˜éŒ„é¡¯ç¤º
- **VPS éƒ¨ç½²**: é€é Tailscale åå‘ä»£ç†æˆåŠŸéƒ¨ç½² (`/polycheese` â†’ port 8888)


### âœ… Phase 2 å·²å®Œæˆ (v2.0.0 Stable)

#### âœ… Phase 5 æ··åˆæ±ºç­–å¼•æ“ (Hybrid Decision Engine) (2026-02-20)

**æ ¸å¿ƒæ©Ÿåˆ¶ï¼šæ¼¸é€²å¼æƒ…ç·’æ•æ„Ÿåº¦ (Sentiment Sensitivity)**
- **å•é¡Œ**ï¼šç´”æŠ€è¡“æŒ‡æ¨™å¯èƒ½å°è‡´åœ¨ FOMO é«˜é»è¿½å¤šï¼Œæˆ–åœ¨æ¥µåº¦ææ…Œä½é»è¿½ç©ºã€‚
- **è§£æ³•**ï¼šåˆ©ç”¨ Polymarket åˆç´„åƒ¹æ ¼ï¼ˆæ•£æˆ¶æƒ…ç·’ï¼‰èˆ‡ Binance åƒ¹æ ¼è·é›¢ç›®æ¨™çš„ã€ŒæŠ€è¡“é¢åˆç†æ©Ÿç‡ã€é€²è¡Œæ¯”å°ï¼Œè¨ˆç®—å‡º **ä¹–é›¢ç‡ (Premium/Sentiment Score)**ã€‚
- **æ¨¡å¼å·®ç•°åŒ–**ï¼š
  - `ultra_aggressive` (æ•æ„Ÿåº¦ 0.0)ï¼šå®Œå…¨ä¸å—æƒ…ç·’å½±éŸ¿ï¼Œå°ˆæ³¨æ•æ‰çªç ´å‹•èƒ½ã€‚
  - `aggressive` (æ•æ„Ÿåº¦ 0.3)ï¼šè¼•å¾®éæ¿¾ã€‚
  - `balanced` (æ•æ„Ÿåº¦ 0.6)ï¼šä¸­åº¦éæ¿¾ã€‚
  - `conservative` / `defensive` (æ•æ„Ÿåº¦ 1.0)ï¼šåš´æ ¼éæ¿¾ã€‚æ¥µåº¦è²ªå©ªæ™‚ï¼Œçœ‹å¤šåˆ†æ•¸æœ€å¤šè¡°æ¸› 90%ï¼›æ¥µåº¦ææ…Œæ™‚ï¼Œé€†å‹¢çœ‹å¤šåˆ†æ•¸æœ€å¤šæ”¾å¤§ 1.3 å€ã€‚

**å¯¦ä½œç´°ç¯€**ï¼š
1. **`app/config.py`**:
   - æ–°å¢ `SENTIMENT_CONFIG` (æ¥µç«¯é–¾å€¼ 60, æœ€å¤§è¡°æ¸› 10%, æœ€å¤§æ”¾å¤§ 1.3x, Sigmoid æ–œç‡ 8.0)ã€‚
   - 5 å€‹äº¤æ˜“æ¨¡å¼å„åŠ å…¥ `sentiment_sensitivity` åƒæ•¸ã€‚
2. **`app/strategy/signal_generator.py`**:
   - æ–°å¢ `_calculate_market_sentiment()`: ä½¿ç”¨ Sigmoid è½‰æ› BTC åƒ¹æ ¼è·é›¢ç‚ºåˆç†æ©Ÿç‡ï¼Œå°æ¯” Polymarket å®šåƒ¹å¾—å‡º `sentiment_score` (-100~+100) èˆ‡æƒ…ç·’æ¨™ç±¤ (EXTREME_GREED ç­‰)ã€‚
   - æ–°å¢ `_parse_strike_price()`: å¾åˆç´„æ¨™é¡Œæå–ç›®æ¨™åƒ¹ã€‚
   - æ–°å¢ `_apply_sentiment_adjustment()`: æ ¹æ“šä¿¡è™Ÿèˆ‡æƒ…ç·’æ˜¯å¦åŒå‘ï¼ŒåŸ·è¡Œã€ŒåŒå‘è¡°æ¸›ã€æˆ–ã€Œé€†å‘æ”¾å¤§ã€çš„æ•¸å­¸è½‰æ›ã€‚
   - ä¿®æ”¹ `generate_signal()` æ¥å— `pm_state`ï¼Œåœ¨å†·å»æœŸå‰å¥—ç”¨æƒ…ç·’èª¿æ•´ã€‚
3. **`app/main.py`**:
   - WebSocket å»£æ’­ `build_dashboard_data()` ä¸­åŠ å…¥ `sentiment`, `raw_score`, `sentiment_adjustment` ç­‰æ¬„ä½ã€‚
4. **å‰ç«¯ UI (`app.js`, `style.css`, `index.html`)**:
   - æ–°å¢ã€ŒğŸ­ å¸‚å ´æƒ…ç·’ã€ç¨ç«‹å¡ç‰‡ã€‚
   - å¯¦ä½œæ¼¸è®Šè‰²æ¢èˆ‡æµ®å‹•æŒ‡é‡ï¼Œç›´è§€é¡¯ç¤ºæƒ…ç·’è½é»ã€‚
   - é¡¯ç¤ºã€Œæº¢åƒ¹ç™¾åˆ†æ¯”ã€èˆ‡ç•¶å‰æ¨¡å¼çš„ã€Œæƒ…ç·’æ•æ„Ÿåº¦ã€ã€‚
   - ä¿¡è™Ÿåˆ†æ•¸ä¸­é¡¯ç¤ºèª¿æ•´å‰/å¾Œçš„å·®ç•° (ä¾‹ï¼š`+9.3 (åŸ +50.0)`)ã€‚

---

#### âœ… Phase 2.1 åˆ©æ½¤éæ¿¾å™¨ (2026-02-18 v2.1.0)
   - **`config.py`**: æ–°å¢ 4 é …è¨­å®šåƒæ•¸
     - `PROFIT_FILTER_ENABLED`: é–‹é—œ (é è¨­é–‹å•Ÿ)
     - `PROFIT_FILTER_MAX_SPREAD_PCT`: æœ€å¤§å…è¨± Spread 2%
     - `PROFIT_FILTER_MIN_PROFIT_RATIO`: é æœŸæ¯›åˆ©éœ€ç‚ºæ‰‹çºŒè²» 1.5 å€
     - `PROFIT_FILTER_MIN_TRADE_AMOUNT`: æœ€ä½äº¤æ˜“é‡‘é¡ $1.0

2. **Polymarket Feed å¢å¼·** ğŸ“Š
   - **`polymarket_feed.py`**: `PolymarketState` æ–°å¢ `up_bid/down_bid/up_spread/down_spread` æ¬„ä½
   - WebSocket è¨Šæ¯è™•ç†åŒæ™‚æ”¶é›† `best_bid` å’Œ `best_ask`
   - `_update_price()` è‡ªå‹•è¨ˆç®— spread æ¯”ä¾‹: `(ask - bid) / ask`
   - `get_snapshot()` è¼¸å‡ºåŒ…å« bid/spread æ•¸æ“š

3. **æ¨¡æ“¬äº¤æ˜“å¼•æ“é‡æ§‹** ğŸ”§
   - **`simulator.py`**: 
     - `execute_trade()` æ–°å¢ `pm_state` åƒæ•¸ï¼Œä½¿ç”¨å¯¦éš›åˆç´„åƒ¹æ ¼å–ä»£ç¡¬ç·¨ç¢¼ 0.5
     - é–‹å€‰å‰ 2 å±¤éæ¿¾: â‘  Spread éå¤§ â†’ æ‹’çµ• â‘¡ é æœŸæ¯›åˆ©ä¸è¶³æ‰‹çºŒè²» 1.5 å€ â†’ æ‹’çµ•
     - `settle_trade()` æ”¹ç”¨ `(1/contract_price - 1)` è¨ˆç®—å‹•æ…‹å›å ±ç‡ï¼Œå–ä»£å¯«æ­»çš„ 85%
     - `SimulationTrade` æ–°å¢ `contract_price` æ¬„ä½

4. **å›æ¸¬å¼•æ“åŒæ­¥ä¿®æ­£** ğŸ”¬
   - **`backtester.py`**: 
     - ç§»é™¤ç¡¬ç·¨ç¢¼ `win_payout_rate=0.85` å’Œ `contract_price=0.50`
     - `BacktestTrade` æ–°å¢ `contract_price` æ¬„ä½
     - `_open_trade()` åŠ å…¥åˆ©æ½¤éæ¿¾å™¨é‚è¼¯
     - `_close_trade()` ä½¿ç”¨å¯¦éš›åˆç´„åƒ¹æ ¼è¨ˆç®—å›å ±ç‡

5. **å‰ç«¯ UI å¼·åŒ–** ğŸ¨
   - **Spread å³æ™‚é¡¯ç¤º**: Polymarket åƒ¹æ ¼å¡ç‰‡é¡¯ç¤º Bid/Ask åƒ¹å·® badge
     - é¡è‰²åˆ†ç´š: ç¶ è‰² â‰¤1% / é»ƒè‰² â‰¤2% / ç´…è‰² >2%
   - **äº¤æ˜“è¨˜éŒ„è¡¨æ ¼**: æ–°å¢ã€Œå¸‚å ´ã€æ¬„ä½ï¼Œé¡¯ç¤º Polymarket å¸‚å ´åç¨±
   - **å¾Œç«¯æ¨æ’­å¢å¼·**: `main.py` çš„ `build_dashboard_data()` å‚³é€ spread æ•¸æ“š


1. **åˆæˆå¸‚å ´æ•¸æ“šç”Ÿæˆå™¨** ğŸ§ª
   - æ–°å¢ `backend/tests/generate_synthetic_data.py`
   - ç”Ÿæˆ 48 å°æ™‚ (2880 ç­†) å¤šé€±æœŸæ­£å¼¦æ³¢ + éš¨æ©Ÿé›œè¨Šçš„ BTC åƒ¹æ ¼æ•¸æ“š
   - åŒ…å«æ¨¡æ“¬ Polymarket UP/DOWN åƒ¹æ ¼ã€æŒ‡æ¨™åˆ†æ•¸ã€Chainlink åƒ¹æ ¼
   - å¯«å…¥ SQLite `market_snapshots` è¡¨ï¼Œä¾›å›æ¸¬å¼•æ“ç›´æ¥ä½¿ç”¨

2. **ç³»çµ±ç©©å®šæ€§å¢å¼·** ğŸ›¡ï¸
   - **æ ¸å¿ƒ Bug ä¿®å¾©**: è§£æ±º `Component.state` property ç¼ºå°‘ setter å°è‡´çš„å•Ÿå‹•å´©æ½°å•é¡Œ (AttributeError)
   - **Chainlink å®¹éŒ¯**: å¢åŠ  3 å€‹å‚™ç”¨ Polygon RPC ç¯€é»ï¼Œå¯¦ç¾è‡ªå‹•è¼ªæ›èˆ‡é‡è©¦æ©Ÿåˆ¶
   - **Polymarket å„ªåŒ–**: å»¶é•· WebSocket æ–·ç·šé‡é€£é–“éš” (5s â†’ 10s)ï¼Œæ”¹å–„éŒ¯èª¤æ—¥èªŒé¡¯ç¤º `repr(e)`
   - **è·¯ç”±æ¸…ç†**: ç§»é™¤ `main.py` ä¸­é‡è¤‡å®šç¾©çš„ API è·¯ç”±

3. **API å…¨é¢é©—è­‰** ğŸ”
   - `/api/performance`: æˆåŠŸå›å‚³å³æ™‚ç¸¾æ•ˆ
   - `/api/components`: æ­£ç¢ºé¡¯ç¤ºæ‰€æœ‰å…ƒä»¶å¥åº·åº¦ (Running/Ready)
   - `/api/bus/stats`: MessageBus çµ±è¨ˆæ­£å¸¸
   - `/api/backtest`: å›æ¸¬å¼•æ“æˆåŠŸåŸ·è¡Œ (Balanced æ¨¡å¼ 83 ç­†äº¤æ˜“ï¼Œå‹ç‡ 55.42%)
   - `/api/llm/*`: Context/Prompt/Advice ç«¯é»çš†æ­£å¸¸å›æ‡‰

#### âœ… æ­·å²å®Œæˆé …ç›®
1. **æ‰‹çºŒè²»æ¨¡å‹ç²¾æº–åŒ–**: å¯¦ä½œ Polymarket 15m æµ®å‹•è²»ç‡ (Buy 0.2-1.6% | Sell 0.8-3.7%)
2. **CPU æ•ˆèƒ½å„ªåŒ–**: è¨‚å–®ç°¿è¼ªè©¢ 5sï¼Œäº¤æ˜“æ•¸æ“šç·©è¡é™è‡³ 2000 ç­†
3. **UI Bug ä¿®å¾©**: è§£æ±ºåå‘ä»£ç†è·¯å¾‘ã€WebSocket é€£ç·šã€åœ–è¡¨æ¸²æŸ“å•é¡Œ
4. **å…ƒä»¶ç‹€æ…‹æ©Ÿ**: `ComponentState` (Initializing/Ready/Running/Stopped/Degraded/Faulted)
5. **äº‹ä»¶é©…å‹• MessageBus**: å–ä»£è¼ªè©¢æ©Ÿåˆ¶ï¼Œå»¶é²é™è‡³ ~2 ç§’
6. **ç¸¾æ•ˆè¿½è¹¤ + å›æ¸¬å¼•æ“**: æ”¯æ´ä¸‰æ¨¡å¼æ¯”è¼ƒã€è‡ªå‹•çµç®—ã€æ¬Šç›Šæ›²ç·šç¹ªè£½
7. **LLM æ™ºèƒ½æ•´åˆ**: çµæ§‹åŒ– Prompt ç”Ÿæˆã€AI å»ºè­°è™•ç†èˆ‡è‡ªå‹•æ‡‰ç”¨
8. **Dashboard å¤§æ”¹ç‰ˆ**: æ–°å¢ 4 å€‹åŠŸèƒ½ Tab (ç¸¾æ•ˆ/å›æ¸¬/AI/å¥åº·)ï¼Œå„ªåŒ– CSS/JS

---

## ğŸ—‚ï¸ å°ˆæ¡ˆçµæ§‹æ¦‚è¦½

```
cheeseproject/
â”œâ”€â”€ backend/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI ä¸»ç¨‹å¼ (å·²æ•´åˆ MessageBus & LLM)
â”‚   â”‚   â”œâ”€â”€ config.py            # å…¨åŸŸè¨­å®š (å« RPC/LLM/Fees è¨­å®š)
â”‚   â”‚   â”œâ”€â”€ database.py          # SQLite è³‡æ–™åº« (å« snapshots/advices è¡¨)
â”‚   â”‚   â”œâ”€â”€ core/                # æ ¸å¿ƒæ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ state.py         # ComponentState ç‹€æ…‹æ©Ÿ (å·²ä¿®å¾© setter)
â”‚   â”‚   â”‚   â””â”€â”€ event_bus.py     # MessageBus äº‹ä»¶åŒ¯æµæ’
â”‚   â”‚   â”œâ”€â”€ data_feeds/          # æ•¸æ“šæº (å« RPC è¼ªæ› & éŒ¯èª¤è™•ç†å„ªåŒ–)
â”‚   â”‚   â”œâ”€â”€ indicators/          # 9 ç¨®æŠ€è¡“æŒ‡æ¨™
â”‚   â”‚   â”œâ”€â”€ strategy/            # ç­–ç•¥æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ signal_generator.py  # äº‹ä»¶é©…å‹•ä¿¡è™Ÿå¼•æ“
â”‚   â”‚   â”‚   â””â”€â”€ fees.py          # æµ®å‹•æ‰‹çºŒè²»æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ trading/
â”‚   â”‚   â”‚   â””â”€â”€ simulator.py    # æ¨¡æ“¬äº¤æ˜“å¼•æ“
â”‚   â”‚   â”œâ”€â”€ performance/        # âœ¨ ç¸¾æ•ˆèˆ‡å›æ¸¬
â”‚   â”‚   â”‚   â”œâ”€â”€ tracker.py       # å³æ™‚ç¸¾æ•ˆè¿½è¹¤
â”‚   â”‚   â”‚   â””â”€â”€ backtester.py    # æ­·å²å›æ¸¬å¼•æ“
â”‚   â”‚   â”œâ”€â”€ llm/                # âœ¨ LLM æ™ºèƒ½æ¨¡çµ„
â”‚   â”‚   â”‚   â”œâ”€â”€ advisor.py       # å»ºè­°è™•ç†å™¨
â”‚   â”‚   â”‚   â””â”€â”€ prompt_builder.py # çµæ§‹åŒ– Context ç”Ÿæˆ
â”‚   â”‚   â””â”€â”€ api/                # API è·¯ç”±
â”‚   â”œâ”€â”€ tests/
â”‚   â”‚   â”œâ”€â”€ generate_synthetic_data.py # âœ¨ åˆæˆæ•¸æ“šç”Ÿæˆå™¨
â”‚   â”‚   â””â”€â”€ ...
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ index.html              # Dashboard UI (å« 4 å€‹æ–° Tab)
â”‚   â”œâ”€â”€ css/style.css           # æ¨£å¼è¡¨ (æ–°å¢ Tab/Card/Chart æ¨£å¼)
â”‚   â””â”€â”€ js/app.js               # å‰ç«¯é‚è¼¯ (æ–°å¢ Tab åˆ‡æ›/å›æ¸¬å‘¼å«/AI äº’å‹•)
â””â”€â”€ ...
```

---

## ğŸ”§ æŠ€è¡“æ¶æ§‹è¦é» (v2.0.0 Stable)

### ç©©å®šæ€§æ”¹é€²
- **ComponentState**: æ‰€æœ‰å…ƒä»¶å…·å‚™è‡ªæˆ‘ç›£æ§èƒ½åŠ›ï¼Œç•°å¸¸æ™‚è‡ªå‹•æ¨™è¨˜ DEGRADED/FAULTEDã€‚
- **MessageBus**: è§£è€¦æ•¸æ“šæºèˆ‡ç­–ç•¥å¼•æ“ï¼Œé¿å…å–®ä¸€çµ„ä»¶é˜»å¡å…¨ç³»çµ±ã€‚
- **PRC Failover**: Chainlink Feed å…§å»º 3 çµ„ RPC ç¯€é»ï¼Œè‡ªå‹•åˆ‡æ›é¿å…å–®é»æ•…éšœã€‚
- **API ç¯€æµ**: ä¿¡è™Ÿç”Ÿæˆå¼·åˆ¶ 2 ç§’é–“éš”ï¼Œé˜²æ­¢é«˜é »æ•¸æ“šçŒçˆ† CPUã€‚

### æ™ºèƒ½æ±ºç­–è¿´åœˆ
1. **Market Data** (Binance/Poly/Chainlink) â†’ MessageBus
2. **Signal Engine** æ¥æ”¶äº‹ä»¶ â†’ è¨ˆç®—æŒ‡æ¨™ â†’ ç”Ÿæˆä¿¡è™Ÿ
3. **LLM Advisor** (Optional) è®€å– Context â†’ çµ¦å‡ºåƒæ•¸èª¿æ•´å»ºè­°
4. **Backtester** (Optional) é©—è­‰æ–°åƒæ•¸ â†’ ç¢ºèªå„ªåŒ–æ•ˆæœ
5. **Simulator** åŸ·è¡Œäº¤æ˜“ â†’ æ›´æ–° Performance Tracker
6. **Dashboard** å¯¦æ™‚å‘ˆç¾æ‰€æœ‰ç‹€æ…‹

---

## ğŸ“Š V2.0.0 æ•ˆèƒ½æŒ‡æ¨™

| é …ç›® | Phase 1 | Phase 2 (æœ€çµ‚ç‰ˆ) |
|------|---------|-----------------|
| CPU ä½¿ç”¨ç‡ | ~50% | <20% (äº‹ä»¶é©…å‹•) |
| ä¿¡è™Ÿå»¶é² | 10 ç§’ | ~2 ç§’ |
| å›æ¸¬é€Ÿåº¦ | N/A | ~1 ç§’ (2880 ç­†æ•¸æ“š) |
| RPC ç©©å®šæ€§ | æ˜“å¤±æ•— | 99.9% (è‡ªå‹•è¼ªæ›) |
| ç³»çµ±æ¢å¾©åŠ› | æ‰‹å‹•é‡å•Ÿ | è‡ªå‹•é‡é€£ / ç‹€æ…‹é™ç´š |

---

## ğŸš€ éƒ¨ç½²æŒ‡å— (æœ€æ–°)

### 1. æ›´æ–°ä»£ç¢¼
```bash
git pull origin main
```

### 2. ç”Ÿæˆæ¸¬è©¦æ•¸æ“š (é¦–æ¬¡éƒ¨ç½²å»ºè­°)
```bash
cd backend
python tests/generate_synthetic_data.py --hours 48
```

### 3. å•Ÿå‹•æœå‹™
```bash
# ä½¿ç”¨ pm2 (æ¨è–¦)
pm2 restart cheesedog

# æˆ–æ‰‹å‹•å•Ÿå‹•
python -m uvicorn app.main:app --host 0.0.0.0 --port 8888
```

### 4. é©—è­‰éƒ¨ç½²
è¨ªå• Dashboard: `http://localhost:8888` æˆ– VPS URL
æª¢æŸ¥ API å¥åº·åº¦: `GET /api/components`

---

## ğŸ“ Session Log: 2026-02-18 00:00 ~ 00:57

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
é©—è­‰å›æ¸¬å¼•æ“èˆ‡ LLM åŠŸèƒ½ã€ä¿®å¾© VPS éƒ¨ç½²å´©æ½°å•é¡Œã€ç”Ÿæˆåˆæˆæ¸¬è©¦æ•¸æ“šã€‚

### âœ… å®Œæˆäº‹é …

#### 1. æ ¸å¿ƒ Bug ä¿®å¾©ï¼š`Component.state` Property Setter è¡çª
- **å•é¡Œ**ï¼š`Component` åŸºé¡çš„ `state` æ˜¯ `@property`ï¼ˆå›å‚³ `ComponentState` æšèˆ‰ï¼‰ï¼Œä½†å­é¡ `BinanceFeed/PolymarketFeed/ChainlinkFeed` åœ¨ `__init__` ä¸­ç”¨ `self.state = XxxState()` è¦†è“‹ï¼Œå› æ²’æœ‰ setter å°è‡´ `AttributeError`
- **ä¿®å¾©**ï¼š
  - `core/state.py`ï¼šå¢åŠ  `state` setterï¼Œå€åˆ† `_component_state`ï¼ˆæšèˆ‰ï¼‰å’Œ `_data_state`ï¼ˆæ•¸æ“šå®¹å™¨ï¼‰
  - æ‰€æœ‰ Feed ä¸­çš„ `self._state` â†’ `self._component_state`
- **å½±éŸ¿ç¯„åœ**ï¼š`state.py`, `binance_feed.py`, `polymarket_feed.py`, `chainlink_feed.py`

#### 2. æ ¸å¿ƒ Bug ä¿®å¾©ï¼š`LOG_LEVEL` å¤§å°å¯«æ•æ„Ÿå°è‡´å•Ÿå‹•å´©æ½° ï¿½
- **å•é¡Œ**ï¼šVPS ç’°å¢ƒè®Šæ•¸ `LOG_LEVEL=info`ï¼ˆå°å¯«ï¼‰â†’ `getattr(logging, "info")` å›å‚³ `logging.info` **å‡½æ•¸**è€Œéæ•´æ•¸ â†’ `TypeError` â†’ pm2 errored â†’ 502
- **ä¿®å¾©**ï¼š
  - `config.py`ï¼š`LOG_LEVEL = os.getenv("LOG_LEVEL", "INFO").upper()` â€” æºé ­å¼·åˆ¶å¤§å¯«
  - `main.py`ï¼šé¡å¤–åŠ å…¥ `isinstance(_log_level, int)` å®‰å…¨æª¢æŸ¥
- **é€™æ˜¯ VPS 502 ERROR çš„ç›´æ¥åŸå› **

#### 3. åˆæˆå¸‚å ´æ•¸æ“šç”Ÿæˆå™¨
- æ–°å¢ `backend/tests/generate_synthetic_data.py`
- æˆåŠŸç”Ÿæˆ **2880 ç­†** (48 å°æ™‚) æ¨¡æ“¬å¸‚å ´å¿«ç…§
- åŒ…å«ï¼šBTC åƒ¹æ ¼ï¼ˆå¤šé€±æœŸæ­£å¼¦æ³¢+é›œè¨Šï¼‰ã€PM UP/DOWN åƒ¹æ ¼ã€Chainlink åƒ¹æ ¼ã€æŒ‡æ¨™ JSON

#### 4. Chainlink RPC ç©©å®šæ€§å¢å¼·
- æ–°å¢ 3 å€‹å‚™ç”¨ Polygon RPC ç¯€é»è‡ªå‹•è¼ªæ›
- é€£çºŒå¤±æ•— 3 æ¬¡è‡ªå‹•åˆ‡æ›åˆ°ä¸‹ä¸€å€‹ RPC
- `polygon-rpc.com` â†’ `polygon-bor-rpc.publicnode.com` â†’ `rpc.ankr.com/polygon`

#### 5. éŒ¯èª¤æ—¥èªŒæ”¹å–„
- æ‰€æœ‰ Feed çš„ `except` å€å¡Šæ”¹ç”¨ `repr(e)` æ›¿ä»£ `str(e)`
- ç¢ºä¿ç•°å¸¸é¡å‹å’Œå®Œæ•´è¨Šæ¯éƒ½èƒ½åœ¨ pm2 æ—¥èªŒä¸­é¡¯ç¤º

#### 6. main.py é‡è¤‡è·¯ç”±æ¸…ç†
- ç§»é™¤é‡è¤‡å®šç¾©çš„ `/api/components` å’Œ `/api/bus/stats` è·¯ç”±

#### 7. API å…¨é¢é©—è­‰é€šé
| API ç«¯é» | ç‹€æ…‹ | å‚™è¨» |
|----------|------|------|
| `/api/performance` | âœ… | å³æ™‚ç¸¾æ•ˆå ±å‘Šæ­£å¸¸ |
| `/api/components` | âœ… | 3 å€‹å…ƒä»¶çš† RUNNING |
| `/api/bus/stats` | âœ… | å·²ç™¼ä½ˆ 23127+ äº‹ä»¶ |
| `/api/backtest` | âœ… | 83 ç­†äº¤æ˜“ï¼Œå‹ç‡ 55.42% |
| `/api/llm/context` | âœ… | çµæ§‹åŒ–ä¸Šä¸‹æ–‡å®Œæ•´ |
| `/api/llm/prompt` | âœ… | åˆ†æ Prompt æ­£å¸¸ç”Ÿæˆ |

### ğŸ” VPS PM2 æ—¥èªŒåˆ†æçµè«–
- **Chainlink RPC å¤±æ•—**ï¼šå…¬å…± RPC å° VPS IP é™æµ â†’ å·²åŠ å‚™ç”¨ç¯€é»è¼ªæ›
- **Polymarket é–“æ­‡æ–·ç·š**ï¼šWebSocket è¶…æ™‚ï¼Œå±¬æ­£å¸¸ç¶²è·¯æ³¢å‹• â†’ å·²å»¶é•·é‡é€£é–“éš”
- **ç³»çµ±é—œé–‰åºåˆ—**ï¼špm2 restart è§¸ç™¼çš„æ­£å¸¸ graceful shutdown
- **502 ERROR æ ¹å› **ï¼š`LOG_LEVEL` å°å¯«å°è‡´å•Ÿå‹•å´©æ½° â†’ å·²ä¿®å¾©

### ğŸ“¦ Git æäº¤è¨˜éŒ„
1. `1a20223` â€” `feat(phase2): v2.0.0 Stable - Complete Phase 2, fix ComponentState setter bug, add synthetic data gen, optimize feeds`
2. `d8a1f5c` â€” `fix(critical): LOG_LEVEL case sensitivity - force uppercase to prevent startup crash on VPS`

---

## ğŸ“ Session Log: 2026-02-18 01:04 ~ 01:14

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
é€éç€è¦½å™¨æª¢æŸ¥ç³»çµ±åŠŸèƒ½ã€å“ç‰Œé‡å‘½åã€ç‰ˆæœ¬è™Ÿä¿®æ­£ã€‚

### âœ… å®Œæˆäº‹é …

#### 1. å“ç‰Œé‡å‘½åï¼šCheeseDog â†’ ä¹³é…ªã®BTCé æ¸¬å®¤
- **å‰ç«¯ HTML**: `<title>`ã€`<meta description>`ã€`<h1>` å“ç‰Œåç¨±å…¨éƒ¨æ›´æ–°
- **å‰ç«¯ CSS/JS**: æª”é ­è¨»è§£åŒæ­¥æ›´æ–°
- **å¾Œç«¯ config.py**: `APP_NAME` æ›´æ–°ç‚ºã€Œä¹³é…ªã®BTCé æ¸¬å®¤ã€
- **å¾Œç«¯ __init__.py**: `__app_name__` + `__version__` åŒæ­¥æ›´æ–°
- **LLM Prompt**: prompt_builder.py ä¸­ 3 è™•å¯è¦‹åç¨±æ›´æ–°
- **å½±éŸ¿ç¯„åœ**: `index.html`, `style.css`, `app.js`, `config.py`, `__init__.py`, `prompt_builder.py`

#### 2. Footer ç‰ˆæœ¬è™Ÿä¿®æ­£
- `v1.0.0` â†’ `v2.0.0`ï¼Œèˆ‡ç³»çµ±å¯¦éš›ç‰ˆæœ¬ä¿æŒä¸€è‡´

#### 3. PM ç°¡ç¨±å…¨é¢æ›¿æ›ç‚º Polymarket
- å‰ç«¯æŒ‡æ¨™å¡ç‰‡ï¼š`PM çœ‹æ¼²åˆç´„` â†’ `Polymarket çœ‹æ¼²`ã€`PM çœ‹è·Œåˆç´„` â†’ `Polymarket çœ‹è·Œ`
- LLM Promptï¼š`PM UP/DOWN/æµå‹•æ€§` â†’ `Polymarket UP/DOWN/æµå‹•æ€§`

#### 4. API åŠŸèƒ½é©—è­‰ (é€é HTTP è«‹æ±‚)
| API ç«¯é» | ç‹€æ…‹ | å‚™è¨» |
|----------|------|------|
| `/` (Dashboard) | âœ… | é é¢æ¨™é¡Œå·²æ›´æ–°ç‚ºã€Œä¹³é…ªã®BTCé æ¸¬å®¤ã€ |
| `/api/status` | âœ… | 3 å€‹ Feed çš† RUNNING |
| `/api/signal` | âœ… | å³æ™‚ä¿¡è™Ÿæ­£å¸¸ |
| `/api/components` | âœ… | å…ƒä»¶å¥åº·åº¦æ­£å¸¸ |
| `/api/performance` | âœ… | ç¸¾æ•ˆå ±å‘Šæ­£å¸¸ |
| `/api/bus/stats` | âœ… | 32,000+ äº‹ä»¶å·²ç™¼ä½ˆ |
| `/api/backtest` | âœ… | 4680 ç­†å¿«ç…§å›æ¸¬å®Œæˆ |
| `/api/backtest/compare` | âœ… | ä¸‰æ¨¡å¼æ¯”è¼ƒå®Œæˆ |
| `/api/llm/context` | âœ… | ç³»çµ±åç¨±å·²æ›´æ–° |
| `/api/llm/prompt` | âœ… | Prompt åç¨±å·²æ›´æ–° |

---

## ğŸ’¬ çµèª

Phase 2 **ã€Œæ™ºèƒ½å­¸ç¿’èˆ‡æ¶æ§‹å„ªåŒ–ã€** å·²åœ“æ»¿å®Œæˆï¼ç³»çµ±ç¾åœ¨å…·å‚™äº†å¼·å¤§çš„å›æ¸¬èƒ½åŠ›ã€ç©©å®šçš„äº‹ä»¶é©…å‹•æ¶æ§‹ã€ä»¥åŠåˆæ­¥çš„ LLM æ•´åˆèƒ½åŠ›ã€‚
æ¥ä¸‹ä¾†çš„ **Phase 3** å°‡å°ˆæ³¨æ–¼å¯¦ç›¤å°æ¥èˆ‡æ›´æ·±åº¦çš„ AI ç­–ç•¥å„ªåŒ–ã€‚

**ä¹³é…ªã®BTCé æ¸¬å®¤ v2.0.0 is ready for launch!** ğŸš€ğŸ§€

---

## ğŸ“ Session Log: 2026-02-18 02:08 ~ 02:30

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
ä¿®å¾© VPS Tailscale Serve åå‘ä»£ç†å­è·¯å¾‘ (`/polycheese`) éƒ¨ç½²æ™‚ï¼Œå‰ç«¯ CSS/JS ç„¡æ³•è¼‰å…¥çš„å•é¡Œã€‚

### ğŸ” å•é¡Œè¨ºæ–·

#### ç—‡ç‹€
- é€é `https://instance-xxx.ts.net/polycheese/` è¨ªå•æ™‚ï¼Œé é¢è¼‰å…¥ç·©æ…¢
- CSS å®Œå…¨è·‘æ‰ï¼Œé é¢ç„¡æ³•æ­£å¸¸é¡¯ç¤º
- å¾ VPS å…§éƒ¨è¨ªå• `127.0.0.1:8888` æ­£å¸¸ï¼ˆHTTP 200 OKï¼‰

#### æ ¹æœ¬åŸå› 
Tailscale Serve å°‡æ‡‰ç”¨æ›è¼‰åˆ°å­è·¯å¾‘ `/polycheese/`ï¼Œä½†å‰ç«¯è³‡æºè·¯å¾‘ç‚ºç›¸å°è·¯å¾‘ï¼ˆ`static/css/style.css`ï¼‰ï¼Œå°è‡´ç€è¦½å™¨å˜—è©¦å¾éŒ¯èª¤çš„è·¯å¾‘è¼‰å…¥è³‡æºï¼š
- **éŒ¯èª¤è·¯å¾‘**: `https://instance-xxx.ts.net/static/css/style.css`
- **æ­£ç¢ºè·¯å¾‘**: `https://instance-xxx.ts.net/polycheese/static/css/style.css`

#### æŠ€è¡“ç´°ç¯€
1. **å¾Œç«¯å·²æœ‰æ©Ÿåˆ¶**ï¼š`main.py` ç¬¬ 368-388 è¡Œå·²å¯¦ä½œå‹•æ…‹æ³¨å…¥ `<base>` æ¨™ç±¤
2. **å‰ç«¯é‚è¼¯éŒ¯èª¤**ï¼š`app.js` ç¬¬ 14-20 è¡Œçš„ `basePath` åµæ¸¬é‚è¼¯æœ‰ fallback åˆ° `location.pathname`ï¼Œæœƒå°‡ `/polycheese/` èª¤åˆ¤ç‚º basePath
3. **é…ç½®ç¼ºå¤±**ï¼š`config.py` çš„ `ROOT_PATH` é è¨­ç‚ºç©ºå­—ä¸²ï¼Œæœªè¨­å®šç‚º `/polycheese`

### âœ… å®Œæˆäº‹é …

#### 1. å¾Œç«¯é…ç½®ä¿®æ­£ï¼š`config.py`
- **ä¿®æ”¹å…§å®¹**ï¼šå°‡ `ROOT_PATH` é è¨­å€¼å¾ç©ºå­—ä¸²æ”¹ç‚º `/polycheese`
- **å½±éŸ¿ç¯„åœ**ï¼š`config.py` ç¬¬ 21-23 è¡Œ
- **ä½œç”¨**ï¼š
  - FastAPI `root_path` åƒæ•¸æ­£ç¢ºè¨­å®šï¼ˆ`main.py` ç¬¬ 346 è¡Œï¼‰
  - `<base>` æ¨™ç±¤æ³¨å…¥æ­£ç¢ºè·¯å¾‘ï¼ˆ`main.py` ç¬¬ 382 è¡Œï¼‰

#### 2. å‰ç«¯è·¯å¾‘åµæ¸¬ä¿®æ­£ï¼š`app.js`
- **ä¿®æ”¹å…§å®¹**ï¼šç§»é™¤ `location.pathname` fallback é‚è¼¯ï¼Œæ”¹ç‚ºåƒ…ä¾è³´ `<base>` æ¨™ç±¤
- **å½±éŸ¿ç¯„åœ**ï¼š`app.js` ç¬¬ 9-23 è¡Œ
- **ä¿®æ­£é‚è¼¯**ï¼š
  ```javascript
  // ä¿®æ­£å‰ï¼ˆéŒ¯èª¤ï¼‰
  if (baseEl && baseEl.getAttribute('href')) {
      basePath = baseEl.getAttribute('href').replace(/\/+$/, '');
  } else {
      basePath = location.pathname.replace(/\/+$/, '');  // âŒ æœƒèª¤åˆ¤
  }
  
  // ä¿®æ­£å¾Œï¼ˆæ­£ç¢ºï¼‰
  if (baseEl && baseEl.getAttribute('href')) {
      basePath = baseEl.getAttribute('href').replace(/\/+$/, '');
  }
  // å¦‚æœæ²’æœ‰ <base> æ¨™ç±¤ï¼Œå‰‡å‡è¨­ç›´æ¥éƒ¨ç½²ï¼ˆç„¡å­è·¯å¾‘ï¼‰
  ```

#### 3. ä¿®å¾©é©—è­‰è¨ˆç•«
- **æœ¬åœ°æ¸¬è©¦**ï¼šåœ¨æœ¬æ©Ÿå•Ÿå‹•æœå‹™ï¼Œç¢ºèªç›´æ¥è¨ªå• `http://localhost:8888` ä»æ­£å¸¸
- **VPS éƒ¨ç½²**ï¼š
  1. æ¨é€ä»£ç¢¼åˆ° Git
  2. VPS æ‹‰å–æœ€æ–°ä»£ç¢¼
  3. é‡å•Ÿ pm2 æœå‹™ï¼š`pm2 restart cheesedog`
  4. è¨ªå• `https://instance-xxx.ts.net/polycheese/` é©—è­‰ CSS/JS è¼‰å…¥æ­£å¸¸

### ğŸ“¦ Git æäº¤è¨˜éŒ„
- `fix(deployment): Tailscale Serve subpath support - set ROOT_PATH=/polycheese, fix frontend basePath detection`

---

---

## ğŸ“… Session Log: 2026-02-18 11:30 ~ 12:20

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
1. **ç›ˆåˆ©èƒ½åŠ›å„ªåŒ–**: å¯¦ä½œåˆ©æ½¤éæ¿¾å™¨ (Profit Filter)ï¼Œé¿å…åœ¨ Spread éå¤§æˆ–åˆ©æ½¤éè–„æ™‚äº¤æ˜“ã€‚
2. **æ‰‹çºŒè²»èˆ‡å›å ±ä¿®æ­£**: ä¿®æ­£æ¨¡æ“¬å™¨èˆ‡å›æ¸¬å¼•æ“ä¸­ç¡¬ç·¨ç¢¼çš„åˆç´„åƒ¹æ ¼èˆ‡å›å ±ç‡ï¼Œæ”¹ç”¨å‹•æ…‹æ•¸æ“šã€‚
3. **å‰ç«¯è³‡è¨Šå¢å¼·**: åœ¨ UI ä¸Šé¡¯ç¤º Polymarket åƒ¹å·® (Spread) èˆ‡äº¤æ˜“å¸‚å ´åç¨±ã€‚

### âœ… å®Œæˆäº‹é …

#### 1. æ ¸å¿ƒé‚è¼¯å‡ç´šï¼šåˆ©æ½¤éæ¿¾å™¨ (Phase 2.1)
- **å¯¦ä½œå…§å®¹**:
  - `simulator.py` èˆ‡ `backtester.py` æ–°å¢é›™é‡éæ¿¾æ©Ÿåˆ¶ï¼š
    1. **Spread éæ¿¾**: è‹¥ `(Ask - Bid) / Ask > 2%` å‰‡æ‹’çµ•äº¤æ˜“ã€‚
    2. **æ¯›åˆ©éæ¿¾**: è‹¥ `é æœŸæ¯›åˆ© < ç¸½æ‰‹çºŒè²» * 1.5` å‰‡æ‹’çµ•äº¤æ˜“ã€‚
  - ä¿®æ­£å›å ±ç‡è¨ˆç®—ï¼šå¾ç¡¬ç·¨ç¢¼ `0.85` æ”¹ç‚ºå‹•æ…‹å…¬å¼ `(1 / contract_price) - 1`ã€‚
  - ä¿®æ­£æ‰‹çºŒè²»è¨ˆç®—ï¼šä½¿ç”¨å¯¦éš›æˆäº¤åƒ¹è¨ˆç®— Entry Feeï¼Œä¸¦åœ¨çµç®—æ™‚æ‰£é™¤ Exit Feeã€‚
- **è¨­å®šåƒæ•¸**: æ–°å¢ `PROFIT_FILTER_ENABLED`, `MAX_SPREAD_PCT`, `MIN_PROFIT_RATIO` ç­‰ Configã€‚

#### 2. å‰ç«¯ UI èˆ‡æ•¸æ“šæµæ•´åˆ
- **WebSocket**: å¾Œç«¯ `main.py` æ¨é€ `pm_up_spread`, `pm_down_spread`, `pm_market_title`ã€‚
- **Web UI**:
  - **Spread Badge**: åœ¨ Polymarket å¡ç‰‡ä¸Šé¡¯ç¤ºåƒ¹å·®ï¼Œä¸¦ä»¥é¡è‰²åˆ†ç´š (ç¶ /é»ƒ/ç´…)ã€‚
  - **äº¤æ˜“è¨˜éŒ„è¡¨æ ¼**: æ–°å¢ã€Œå¸‚å ´ã€æ¬„ä½ï¼Œé¡¯ç¤º "BTC 15m ..." ç­‰è³‡è¨Šã€‚
  - **ç›ˆè™§é¡¯ç¤º**: ä¿®æ­£ PnL é¡¯ç¤ºé‚è¼¯ï¼Œç¢ºä¿ç•™å€‰èˆ‡çµç®—ç‹€æ…‹æ­£ç¢ºã€‚

#### 3. ç³»çµ±é©—è­‰ (Testing)
- **å–®å…ƒæ¸¬è©¦**: `tests/test_profit_filter.py` é©—è­‰ä¸‰ç¨®å ´æ™¯ (Spreadéå¤§/åˆ©æ½¤ä¸è¶³/æ­£å¸¸)ï¼Œçµæœå…¨æ•¸é€šé âœ…ã€‚
- **æ•´åˆæ¸¬è©¦**: `tests/test_ws_integration.py` é©—è­‰ WebSocket æ•¸æ“šå°åŒ…å®Œæ•´æ€§ï¼Œçµæœé€šé âœ…ã€‚
- **UI é©—è­‰**: ç¢ºèªéœæ…‹è³‡æºè¼‰å…¥èˆ‡æ•¸æ“šé¡¯ç¤ºæ­£å¸¸ã€‚

### ğŸ“… ä¸‹ä¸€æ­¥è¨ˆåŠƒ (Phase 3: Strategy Optimization)

#### 1. ç­–ç•¥åƒæ•¸æœ€ä½³åŒ–
- åˆ©ç”¨ `generate_synthetic_data.py` ç”Ÿæˆçš„æ¨¡æ“¬æ•¸æ“šé€²è¡Œå¤§è¦æ¨¡å›æ¸¬ã€‚
- èª¿æ•´ `SignalGenerator` çš„æŒ‡æ¨™æ¬Šé‡ï¼Œå°‹æ‰¾æœ€ä½³ Sharpe Ratio çµ„åˆã€‚

#### 2. é€²éšè¨‚å–®ç®¡ç†
- å¯¦ä½œ **Trailing Stop** (ç§»å‹•åœåˆ©) é‚è¼¯ã€‚
- è€ƒæ…®åŠ å…¥ **Time-based Exit** (æ™‚é–“å‡ºå ´) æ©Ÿåˆ¶ï¼ˆä¾‹å¦‚åˆ°æœŸå‰ 5 åˆ†é˜å¼·åˆ¶å¹³å€‰ä»¥è¦é¿æ¥µç«¯æ³¢å‹•ï¼‰ã€‚

### ğŸ“¦ Git æäº¤è¨˜éŒ„ (Pending)
- `[å·¥ä½œå€æš«å­˜]` â€” `feat(phase2.1): implement profit filter, dynamic fees, and UI spread display`

---

## ğŸ“… Session Log: 2026-02-18 12:20 ~ 12:30 (Hotfix)
("å¤–éƒ¨ AI é€é POST /api/llm/advice é€å…¥å»ºè­°ï¼Œåº•éƒ¨æ¬„ä½å°±æœƒåœ¨ä¸‹ä¸€æ¬¡ WebSocket æ¨æ’­æ™‚è‡ªå‹•æ›´æ–°é¡¯ç¤ºã€‚")

### ğŸ› ä¿®å¾© Bugï¼šAI å»ºè­°æ¬„ä½ç„¡é¡¯ç¤º
**å•é¡Œæè¿°**ï¼šWeb UI åº•éƒ¨æ§åˆ¶åˆ—çš„ AI å»ºè­°æ¬„ä½å§‹çµ‚é¡¯ç¤ºã€Œç³»çµ±å°±ç·’...ã€ï¼Œç„¡æ³•é¡¯ç¤ºå¯¦éš›å»ºè­°ã€‚
**æ ¹æœ¬åŸå› **ï¼š
1. **å¾Œç«¯æ¼é€**ï¼š`main.py` çš„ WebSocket payload (`build_dashboard_data`) æœªåŒ…å« `latest_advice`ã€‚
2. **å‰ç«¯æ¼æ¥**ï¼š`app.js` ç¼ºä¹æ›´æ–°åº•éƒ¨ `#advice-content` DOM å…ƒç´ çš„æ¸²æŸ“å‡½æ•¸ã€‚
3. **æ¨£å¼ç¼ºå¤±**ï¼š`style.css` ç¼ºä¹å°æ‡‰çš„ CSS é¡åˆ¥ã€‚

**ä¿®å¾©å…§å®¹**ï¼š
- **Backend**: `main.py` æ–°å¢ `latest_advice` è‡³ WebSocket æ¨æ’­æ•¸æ“šã€‚
- **Frontend**:
  - `app.js`: å¯¦ä½œ `renderLatestAdvice()` ä¸¦æ•´åˆè‡³ `renderDashboard()`ã€‚
  - `style.css`: æ–°å¢ `.advice-live`, `.advice-icon` ç­‰æ¨£å¼èˆ‡æ·¡å…¥å‹•ç•«ã€‚

---

## ğŸ“… Session Log: 2026-02-18 12:49 ~ 13:06 (Phase 3: Signal Quality Enhancement)

### ğŸš€ Phase 3 P0: ä¿¡è™Ÿå“è³ªæ”¹å–„ (Signal Quality Enhancement)

**ç›®æ¨™**ï¼šå°‡ä¿¡è™Ÿå¼•æ“å¾ã€ŒäºŒå…ƒåˆ¤å®šã€å‡ç´šç‚ºã€Œé€£çºŒå‡½æ•¸ã€ï¼Œä¸¦æ–°å¢æ³¢å‹•ç‡ç¶­åº¦èˆ‡å†·å»æœŸæ©Ÿåˆ¶ã€‚

#### âœ… B1: EMA äº¤å‰ â†’ é€£çºŒå‡½æ•¸
- **èˆŠ**ï¼š`ema_s > ema_l` â†’ `+w`ï¼ˆäºŒå…ƒé–‹é—œï¼‰
- **æ–°**ï¼šè¨ˆç®— `(ema_s - ema_l) / ema_l` çš„åé›¢æ¯”ä¾‹ï¼Œç”¨ `tanh()` å£“ç¸®åˆ° `[-1, +1]`
- **æ•ˆæœ**ï¼šEMA åé›¢ 0.5% æ™‚æ‰é£½å’Œï¼Œå¾®å°äº¤å‰ä¸å†çµ¦æ»¿åˆ†

#### âœ… B2: MACD Histogram å¹…åº¦åŒ–
- **èˆŠ**ï¼š`histogram > 0` â†’ `+w`ï¼ˆäºŒå…ƒé–‹é—œï¼‰
- **æ–°**ï¼šç”¨ `mid_price * 0.1%` ç‚ºåƒè€ƒåŸºæº–æ­£è¦åŒ– histogramï¼Œå†ç”¨ `tanh()` å£“ç¸®
- **æ•ˆæœ**ï¼šå¤§ histogram = å¼·å‹•èƒ½ â†’ é«˜åˆ†ï¼Œå° histogram = å¼±å‹•èƒ½ â†’ ä½åˆ†

#### âœ… B3: RSI æ¥µç«¯å€åŸŸåŠ å¼·
- **èˆŠ**ï¼šRSI <30 â†’ `+w`ï¼Œ>70 â†’ `-w`ï¼Œä¸­é–“ç·šæ€§
- **æ–°**ï¼š
  - æ¥µç«¯å€åŸŸ (<20, >80) â†’ 1.5x æ¬Šé‡æ”¾å¤§
  - è¶…è²·è¶…è³£å€ (20-30, 70-80) â†’ æ¼¸é€²åŠ å¼·
  - ä¸­é–“å€åŸŸ (30-70) â†’ æ”¹ç”¨ `tanh()` sigmoid æ›²ç·šå–ä»£ç·šæ€§
- **æ•ˆæœ**ï¼šRSI=15 çš„è¶…è³£ä¿¡è™Ÿæ¯” RSI=28 å¼·å¾—å¤š

#### âœ… B4: æ–°å¢ Bollinger Band æŒ‡æ¨™
- **æª”æ¡ˆ**ï¼š`indicators/technical.py` æ–°å¢ `bollinger_bands()` å‡½æ•¸
- **è¨ˆç®—**ï¼šSMA(20) Â± 2Ïƒ â†’ è¨ˆç®— %B å€¼ï¼ˆåƒ¹æ ¼åœ¨é€šé“ä¸­çš„ä½ç½®ï¼‰å’Œå¸¶å¯¬
- **æ¬Šé‡**ï¼š`config.py` æ–°å¢ `bb: 5`ï¼Œä¸‰ç¨®æ¨¡å¼åŠ å…¥å°æ‡‰ä¹˜æ•¸
- **æ•ˆæœ**ï¼šå¡«è£œç³»çµ±å®Œå…¨ç¼ºå¤±çš„ã€Œæ³¢å‹•ç‡ã€ç¶­åº¦

#### âœ… B5: ä¿¡è™Ÿå†·å»æœŸ (Cooldown)
- **åƒæ•¸**ï¼š`SIGNAL_COOLDOWN_SECONDS = 120`ï¼ˆ2 åˆ†é˜ï¼‰
- **é‚è¼¯**ï¼šåŒæ–¹å‘ä¿¡è™Ÿåœ¨å†·å»æœŸå…§ä¸é‡è¤‡è§¸ç™¼ï¼Œé˜²æ­¢çŸ­æ™‚é–“å…§é‡è¤‡é–‹å€‰
- **ä¿¡è™Ÿå›å‚³**ï¼šæ–°å¢ `cooldown_blocked: bool` æ¬„ä½

#### âœ… CRO Dashboard API
- **ç«¯é»**ï¼š`GET /api/cro/stats`
- **åŠŸèƒ½**ï¼šç‚º VPS ä¸Šçš„ AI Agent (OpenClaw) æä¾›é«˜å±¤æ¬¡æ±ºç­–æ•¸æ“š
- **å›å‚³å…§å®¹**ï¼š
  - ç¸¾æ•ˆçµ±è¨ˆï¼ˆå‹ç‡ã€é€£æ•—ã€ç²åˆ©å› å­ï¼‰
  - å¸‚å ´ç‹€æ…‹ï¼ˆBTC æ³¢å‹•ç‡ã€Polymarket æµå‹•æ€§ï¼‰
  - ç³»çµ±å¥åº·åº¦
  - **Advisories**ï¼šè‡ªå‹•ç”Ÿæˆçš„é¢¨éšªå»ºè­°ï¼ˆALPHA_DECAY / HIGH_VOLATILITY / LOW_LIQUIDITY / LOSING_STREAK / HOT_STREAKï¼‰

### ä¿®æ”¹æª”æ¡ˆæ¸…å–®
| æª”æ¡ˆ | æ”¹å‹•é¡å‹ |
| :--- | :--- |
| `backend/app/indicators/technical.py` | æ–°å¢ `bollinger_bands()` å‡½æ•¸ |
| `backend/app/config.py` | æ–°å¢ `bb` æ¬Šé‡ã€æ¨¡å¼ä¹˜æ•¸ã€`SIGNAL_COOLDOWN_SECONDS` |
| `backend/app/strategy/signal_generator.py` | **å®Œæ•´é‡å¯«** â€” B1~B5 + CRO çµ±è¨ˆ |
| `backend/app/main.py` | æ–°å¢ `/api/cro/stats` ç«¯é» |
| `AI_Agent_Suggession_Phase3.txt` | OpenClaw è§’è‰²è½‰å‹å»ºè­°æ›¸ |

### é©—è­‰çµæœ
- âœ… æ¨¡çµ„è¼‰å…¥é©—è­‰é€šé (SignalGenerator + bollinger_bands + config)
- âœ… CRO API æ¸¬è©¦é€šéï¼ˆç¢ºèªå›å‚³å®Œæ•´ JSON çµæ§‹ï¼‰
- âœ… å¾Œç«¯æ­£å¸¸å•Ÿå‹•ï¼ˆç„¡èªæ³•éŒ¯èª¤ï¼‰

### ğŸ”® Next Steps (Phase 3 P1 & P2)

#### Phase 3 P1: æ¬Šé‡æ ¡æº– (Weight Calibration)
- **ç›®æ¨™**ï¼šä¸å†ä¾è³´ç¶“é©—å€¼ï¼Œåˆ©ç”¨å›æ¸¬å¼•æ“æ‰¾å‡ºæ•¸å­¸ä¸Šæœ€ä½³çš„ `BIAS_WEIGHTS`ã€‚
- **ä½œæ³•**ï¼šæ’°å¯« `calibrate_weights.py`ï¼Œå°æ¯å€‹æŒ‡æ¨™é€²è¡Œæ¬Šé‡æƒæï¼Œä»¥ Sharpe Ratio æœ€å¤§åŒ–ç‚ºç›®æ¨™ã€‚

#### Phase 3 P2: é¢¨éšªç®¡ç†å¼·åŒ– (Risk Management)
- **ç›®æ¨™**ï¼šå‹•æ…‹èª¿æ•´å€‰ä½å¤§å°ï¼Œé¿å…åœ¨é€£æ•—æ™‚çˆ†å€‰ã€‚
- **ä½œæ³•**ï¼šå¼•å…¥ Kelly Criterion (å‡±åˆ©å…¬å¼) è¨ˆç®—æœ€ä½³å€‰ä½ï¼Œå¯¦ä½œé€£æ•—ç†”æ–·æ©Ÿåˆ¶ã€‚

### ğŸ“¦ Git æäº¤è¨˜éŒ„ (Pending)
- `feat(phase3): enhance signal quality with continuous functions and bollinger bands`
- `feat(phase3): implement CRO dashboard API for AI agent integration`
- `docs(phase3): add AI agent role transformation proposal`

---

## ğŸ“… Session Log: 2026-02-18 14:27 ~ 14:51 (Phase 3 P1: Weight Calibration)

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
Phase 3 P1 â€” åˆ©ç”¨å›æ¸¬å¼•æ“å¤§è¦æ¨¡æœç´¢æœ€ä½³ `BIAS_WEIGHTS` æŒ‡æ¨™æ¬Šé‡çµ„åˆï¼Œå–ä»£äººå·¥ç¶“é©—èª¿åƒã€‚

### âœ… å®Œæˆäº‹é …

#### 1. æ¬Šé‡æ ¡æº–å·¥å…· `tools/calibrate_weights.py`
- **æœç´¢ç­–ç•¥**:
  1. **Phase 0 â€” Baseline**: ä½¿ç”¨ç¾æœ‰æ¬Šé‡åšåŸºæº–æ¸¬è©¦
  2. **Phase 1 â€” Random Search (200 æ¬¡)**: åœ¨æ•´å€‹æ¬Šé‡ç©ºé–“ä¸­å‡å‹»æ¡æ¨£
  3. **Phase 2 â€” Hill Climbing (Top-5 èµ·é» Ã— 80 æ¬¡)**: å°æœ€ä½³å€™é¸é€²è¡Œå±€éƒ¨å¾®èª¿
  4. **Phase 3 â€” Cross Validation (3 æŠ˜)**: é©—è­‰æ¬Šé‡ç©©å®šæ€§ï¼Œé˜²æ­¢ overfitting
- **ç›®æ¨™å‡½æ•¸ (Composite Score)**:
  - `Sharpe Ratio Ã— 0.40 + å‹ç‡ Ã— 0.25 + ç²åˆ©å› å­ Ã— 0.25 - æœ€å¤§å›æ’¤ Ã— 0.10`
- **åŠŸèƒ½ç‰¹æ€§**:
  - æ”¯æ´å‘½ä»¤åˆ—åƒæ•¸ (`-n`, `--hill`, `--cv`, `--mode`, `--seed`, `--apply`)
  - è‡ªå‹•åŒ¯å‡º JSON çµæœè‡³ `data/calibration_*.json`
  - å¯é¸ `--apply` ç›´æ¥å¯«å› `config.py`ï¼ˆå«ç¢ºèªæç¤ºï¼‰
  - å¤§å¹…å£“åˆ¶å›æ¸¬æ—¥èªŒï¼Œåƒ…é¡¯ç¤ºé€²åº¦æ‘˜è¦
  - é è¼‰å¿«ç…§é¿å…é‡è¤‡ I/O

#### 2. å›æ¸¬å¼•æ“å¢å¼· `backtester.py`
- **æ–°å¢ `BacktestConfig` é¸é …**:
  - `use_saved_signals: bool = True` â€” æ ¡æº–æ™‚è¨­ç‚º Falseï¼Œå¼·åˆ¶ä½¿ç”¨ SignalGenerator è¨ˆç®—
  - `disable_cooldown: bool = False` â€” æ ¡æº–æ™‚è¨­ç‚º Trueï¼Œç¦ç”¨å†·å»æœŸè®“äº¤æ˜“æ›´å¤š
- **K ç·šæ¨¡æ“¬æ”¹å–„**:
  - **èˆŠ**: `h = price * 1.0001, l = price * 0.9999`ï¼ˆå¹¾ä¹ç„¡æ³¢å‹•ï¼‰
  - **æ–°**: ä½¿ç”¨ç›¸é„°å¿«ç…§çš„å¯¦éš›åƒ¹å·®å»ºæ§‹ OHLCVï¼ŒåŠ å…¥åˆç†çš„æ³¢å‹•å¹…åº¦
  - æˆäº¤é‡ä¹Ÿæ”¹ç‚ºå‹•æ…‹ï¼ˆæ ¹æ“šåƒ¹æ ¼è®Šå‹•å¹…åº¦èª¿æ•´ï¼‰
- **å½±éŸ¿**: æŠ€è¡“æŒ‡æ¨™ï¼ˆEMAã€RSIã€MACDã€BBï¼‰ç¾åœ¨èƒ½æ­£ç¢ºåæ˜ åƒ¹æ ¼å‹•æ…‹

#### 3. æ ¡æº–çµæœï¼ˆBalanced æ¨¡å¼ï¼Œ5000 ç­†å¿«ç…§ï¼Œ304 æ¬¡è¿­ä»£ï¼‰

| æŒ‡æ¨™   | èˆŠæ¬Šé‡ | **æ–°æ¬Šé‡** | è®ŠåŒ–  | å‚™è¨» |
|--------|--------|-----------|-------|------|
| EMA    | 10     | **12**    | +2 â†‘  | æœ€å¼·è¶¨å‹¢æŒ‡æ¨™ï¼Œæ ¡æº–å¾Œæ›´é‡è¦ |
| OBI    | 8      | **8**     | â”€     | è¨‚å–®ç°¿å¤±è¡¡ï¼Œæ¬Šé‡ç©©å®š |
| MACD   | 8      | **7**     | -1 â†“  | å‹•èƒ½æŒ‡æ¨™ï¼Œç•¥é™ |
| CVD    | 7      | **1**     | -6 â†“  | å›æ¸¬ç„¡è¨‚å–®ç°¿æ•¸æ“šï¼Œè²¢ç»ä½ |
| HA     | 6      | **7**     | +1 â†‘  | è¶¨å‹¢ç¢ºèªæŒ‡æ¨™ï¼Œç•¥å‡ |
| VWAP   | 5      | **1**     | -4 â†“  | å›æ¸¬ç’°å¢ƒä¸­æ•ˆæœæœ‰é™ |
| RSI    | 5      | **9**     | +4 â†‘  | æ¥µç«¯å€åŸŸåŠ å¼·å¾Œæ•ˆæœé¡¯è‘— |
| BB     | 5      | **4**     | -1 â†“  | æ³¢å‹•ç‡ç¶­åº¦ï¼Œå£“ç•¥é™ |
| POC    | 3      | **0**     | -3 â†“  | å›æ¸¬ç„¡è¨‚å–®ç°¿æ•¸æ“šï¼Œè²¢ç»ç‚ºé›¶ |
| Walls  | 4      | **1**     | -3 â†“  | åŒä¸Š |

**æ ¡æº–ç¸¾æ•ˆæ¯”è¼ƒ**:
- **Baseline**: Composite=0.547 | Sharpe=79.87 | å‹ç‡=62.5% | 8 ç­†äº¤æ˜“
- **æœ€ä½³æ¬Šé‡**: Composite=0.753 | Sharpe=64.15 | å‹ç‡=57.1% | 21 ç­†äº¤æ˜“

**é—œéµæ´å¯Ÿ**:
1. **EMA + RSI** æ˜¯å›æ¸¬ç’°å¢ƒä¸­æœ€æœ‰æ•ˆçš„æŒ‡æ¨™çµ„åˆ
2. **CVDã€VWAPã€POCã€Walls** å› å›æ¸¬ç¼ºä¹è¨‚å–®ç°¿/å³æ™‚äº¤æ˜“æ•¸æ“šï¼Œè‡ªç„¶è¢«æ ¡æº–å™¨é™æ¬Š
3. æ–°æ¬Šé‡ç”¢ç”Ÿæ›´å¤šäº¤æ˜“ (8â†’21)ï¼Œæ›´å…·çµ±è¨ˆæ„ç¾©
4. âš ï¸ æ ¡æº–çµæœç‚ºåˆæˆæ•¸æ“šç’°å¢ƒæœ€ä½³å€¼ï¼Œå¯¦ç›¤éœ€æ­é…å³æ™‚æ•¸æ“šå†æ¬¡é©—è­‰

### ğŸ“ æ³¨æ„äº‹é …
- æ ¡æº–å¾Œçš„æ¬Šé‡é©ç”¨æ–¼ **å›æ¸¬/æ¨¡æ“¬ç’°å¢ƒ**ï¼ˆç„¡è¨‚å–®ç°¿æ•¸æ“šï¼‰
- **å¯¦ç›¤å»ºè­°**ï¼šä¿ç•™ OBIã€CVDã€Walls ç­‰æŒ‡æ¨™çš„åŸå§‹æ¬Šé‡ï¼Œåƒ…èª¿æ•´å›æ¸¬å¯é©—è­‰çš„æŒ‡æ¨™
- æœªä¾†å¯åœ¨ VPS ä¸Šæ”¶é›†å¯¦ç›¤å¿«ç…§å¾Œï¼Œé‡æ–°æ ¡æº–ä»¥ç²å¾—æ›´æº–ç¢ºçš„æ¬Šé‡

### ä¿®æ”¹æª”æ¡ˆæ¸…å–®
| æª”æ¡ˆ | æ”¹å‹•é¡å‹ |
| :--- | :--- |
| `backend/tools/calibrate_weights.py` | âœ¨ æ–°å¢ â€” å®Œæ•´æ ¡æº–å·¥å…· (~590 è¡Œ) |
| `backend/app/performance/backtester.py` | å¢å¼· â€” æ–°å¢ 3 å€‹ Config é¸é … + K ç·šæ¨¡æ“¬æ”¹å–„ |

### ğŸ“¦ Git æäº¤è¨˜éŒ„ (Pending)
- `feat(phase3-p1): implement weight calibration tool with random search + hill climbing`
- `fix(backtester): improve simulated kline OHLCV and add calibration-mode options`

---

## ğŸ“… Session Log: 2026-02-18 14:56 ~ 15:20 (Phase 3 P1 çºŒ + P2)

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
1. Phase 3 P1 çºŒ â€” ç”¨çœŸå¯¦ Binance æ­·å²æ•¸æ“šé‡æ–°æ ¡æº–æ¬Šé‡
2. Phase 3 P1 çºŒ â€” äº¤æ˜“æ¨¡å¼å¾ 3 ç´šæ“´å±•åˆ° 5 ç´š
3. Phase 3 P1 çºŒ â€” å»ºç«‹ VPS è‡ªå‹•æ ¡æº–æ’ç¨‹å·¥å…·
4. Phase 3 P2 â€” å¯¦ä½œ Kelly Criterion + Circuit Breakers é¢¨éšªç®¡ç†

### âœ… å®Œæˆäº‹é …

#### 1. çœŸå¯¦æ•¸æ“šæ ¡æº– `tools/fetch_historical_data.py`
- å¾ Binance API ä¸‹è¼‰æœ€è¿‘ 16 å°æ™‚çš„ BTCUSDT 1m K ç·š (960 æ ¹)
- è¨ˆç®—çœŸå¯¦æŠ€è¡“æŒ‡æ¨™ (EMA, RSI, MACD, BB, HA)
- æ¨¡æ“¬ Polymarket åˆç´„åƒ¹æ ¼
- çœŸå¯¦è¡Œæƒ…æ ¡æº–çµæœï¼š
  - Rank 1 (å‹•èƒ½è¿½éš¨): **MACD=14, HA=11** | Sharpe=98.63 | å‹ç‡ 69%
  - Rank 5 (ç©©å¥çªç ´): **HA=12, BB=8** | Sharpe=103.18 | å‹ç‡ 70.6% â† **å·²æ¡ç”¨**

#### 2. 5 ç´šäº¤æ˜“æ¨¡å¼ `config.py`
| ç­‰ç´š | åç¨± | ä¿¡è™Ÿé–€æª» | æœ€å¤§å€‰ä½ | é©åˆå ´æ™¯ |
|------|------|---------|---------|---------|
| âš¡ ultra_aggressive | è¶…æ¿€é€² | 15 | 40% | æ¥µå¼·è¶¨å‹¢ |
| ğŸ”¥ aggressive | ç©æ¥µ | 25 | 30% | å¼·/æº«å’Œè¶¨å‹¢ |
| âš–ï¸ balanced | å¹³è¡¡ | 40 | 20% | å¤šæ•¸è¡Œæƒ… |
| ğŸ›¡ï¸ conservative | ä¿å®ˆ | 55 | 12% | éœ‡ç›ª/æ··æ²Œ |
| ğŸ° defensive | é˜²ç¦¦ | 70 | 8% | å´©ç›¤/é«˜æ³¢å‹• |

#### 3. å¸‚å ´ç‹€æ…‹è‡ªå‹•åµæ¸¬ `MARKET_REGIME_CONFIG`
- åµæ¸¬ 5 ç¨®å¸‚å ´ç‹€æ…‹: strong_trend / mild_trend / ranging / choppy / crash
- åŸºæ–¼æ³¢å‹•ç‡ + è¶¨å‹¢å¼·åº¦è‡ªå‹•æ¨è–¦æœ€é©äº¤æ˜“æ¨¡å¼
- æ¨¡å¼åˆ‡æ›å†·å»æœŸ 5 åˆ†é˜

#### 4. VPS è‡ªå‹•æ ¡æº– `tools/auto_calibrate.py`
- å®Œæ•´ 10 æ­¥é©Ÿè‡ªå‹•æ ¡æº–æµç¨‹
- å¸‚å ´ç‹€æ…‹åµæ¸¬ â†’ æ•¸æ“šä¸‹è¼‰ â†’ æ ¡æº– â†’ äº¤å‰é©—è­‰ â†’ æ¢ä»¶å¼æ›´æ–°
- æ›´æ–°æ¢ä»¶: æ”¹å–„ â‰¥ 10% + ç©©å®šæ€§ > 0.3 + äº¤æ˜“ â‰¥ 5 ç­†
- æ ¡æº–æ­·å²åˆ†æåŠŸèƒ½ï¼ˆ`--history`ï¼‰ï¼Œè­˜åˆ¥å“ªäº›æŒ‡æ¨™æ¬Šé‡ç©©å®š/è®Šå‹•å¤§
- æ”¯æ´ `--dry-run`ã€`--threshold`ã€`--notify` ç­‰åƒæ•¸

#### 5. Phase 3 P2: Kelly Criterion é¢¨éšªç®¡ç† `risk_manager.py`
- **Kelly Criterion å€‰ä½è¨ˆç®—**:
  - å…¬å¼: `f* = (pÃ—b - q) / b`
  - ä½¿ç”¨ Half-Kelly (fraction=0.5) é™ä½ç ´ç”¢é¢¨éšª
  - å‹•æ…‹è¨ˆç®—ï¼šæ ¹æ“šæœ€è¿‘ 20 ç­†äº¤æ˜“çš„å‹ç‡å’Œè³ ç‡å³æ™‚æ›´æ–°
- **4 å±¤ Circuit Breakers**:
  1. æ—¥è™§æä¸Šé™ (10%)
  2. é€£æ•—ä¸Šé™ (5 ç­†)
  3. æœ€å¤§å›æ’¤ (20%)
  4. æ—¥äº¤æ˜“æ¬¡æ•¸ (30 ç­†)
  - è§¸ç™¼å¾Œè‡ªå‹•å†·å» 30 åˆ†é˜
- **å‹•æ…‹å€‰ä½èª¿æ•´å› å­**:
  - ä¿¡å¿ƒåº¦èª¿æ•´ (confidence_mult)
  - æ³¢å‹•ç‡èª¿æ•´ (vol_mult)
  - é€£æ•—æ‡²ç½° (streak_penalty: æ¯å¤šé€£æ•— 1 æ¬¡é™ 15%)
- **ç¶œåˆé¢¨éšªè©•åˆ†** (0~100)

#### 6. å‰ç«¯æ›´æ–°
- å›æ¸¬ dropdown + åº•éƒ¨æ¨¡å¼æŒ‰éˆ•: 3 â†’ 5 å€‹
- ã€Œä¸‰æ¨¡å¼æ¯”è¼ƒã€â†’ã€Œäº”æ¨¡å¼æ¯”è¼ƒã€
- ç‰ˆæœ¬è™Ÿ v2.0.0 â†’ v3.1.0

### ä¿®æ”¹æª”æ¡ˆæ¸…å–®
| æª”æ¡ˆ | æ”¹å‹•é¡å‹ |
| :--- | :--- |
| `backend/tools/fetch_historical_data.py` | âœ¨ æ–°å¢ â€” Binance çœŸå¯¦æ•¸æ“šä¸‹è¼‰ |
| `backend/tools/auto_calibrate.py` | âœ¨ æ–°å¢ â€” VPS è‡ªå‹•æ ¡æº–æ’ç¨‹ |
| `backend/app/trading/risk_manager.py` | âœ¨ æ–°å¢ â€” Kelly + Circuit Breakers |
| `backend/app/config.py` | å¤§å¹…å¢å¼· â€” Rank5 æ¬Šé‡ + 5 ç´šæ¨¡å¼ + MARKET_REGIME + RISK_MANAGEMENT |
| `backend/app/trading/simulator.py` | å¢å¼· â€” æ•´åˆ RiskManager |
| `backend/app/main.py` | å¢å¼· â€” æ–°å¢ /api/risk ç«¯é» |
| `frontend/index.html` | æ›´æ–° â€” 5 ç´šæ¨¡å¼ UI + ç‰ˆæœ¬è™Ÿ |

### ğŸ“¦ Git æäº¤è¨˜éŒ„ (Pending)
- `feat(phase3-p1): add real Binance data fetcher and auto-calibration tool`
- `feat(phase3-p1): expand trading modes from 3 to 5 with market regime detection`
- `feat(phase3-p2): implement Kelly Criterion position sizing and circuit breakers`
- `refactor(simulator): integrate RiskManager for dynamic position sizing`

---

**ä¹³é…ªã®BTCé æ¸¬å®¤ v3.2.0 (Phase 3 P2: Risk Management)** ğŸš€ğŸ§€

---

## ğŸ“… Session Log: 2026-02-19 22:00 ~ 22:20 (Phase 3 P1: Custom LLM Integration)

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
æ•´åˆä½¿ç”¨è€…è‡ªå®šç¾©çš„ OpenAI-compatible API (LLM)ï¼Œå°‡å¤–éƒ¨ AI Agent åŠŸèƒ½å…§å»ºåŒ–ï¼Œä¸¦æä¾› Web UI é€²è¡Œè¨­å®šèˆ‡åˆ‡æ›ã€‚

### âœ… å®Œæˆäº‹é …

#### 1. å…§å»º AI å¼•æ“ (Internal AI Engine) ğŸ§ 
- **æ¨¡çµ„**: `backend/app/llm/engine.py`
- **åŠŸèƒ½**:
  - å–ä»£å¤–éƒ¨ Agent è…³æœ¬ï¼Œç›´æ¥ç”±å¾Œç«¯å®šæœŸ (é è¨­ 15 åˆ†é˜) å‘¼å« LLM APIã€‚
  - ä½¿ç”¨ `prompt_builder` ç”Ÿæˆç³»çµ±å¿«ç…§ã€‚
  - å°‡ LLM å›æ‡‰é¤µçµ¦ `llm_advisor` åŸ·è¡Œå»ºè­° (æ¨¡å¼åˆ‡æ›/é¢¨éšªç®¡æ§)ã€‚
  - æ”¯æ´ `config.AI_MONITOR_ENABLED` é–‹é—œã€‚

#### 2. é…ç½®èˆ‡ API æ•´åˆ ğŸ”§
- **`config.py`**:
  - æ–°å¢ `AI_MONITOR_ENABLED`, `AI_MONITOR_INTERVAL`ã€‚
  - æ–°å¢ `OPENAI_API_KEY`, `OPENAI_BASE_URL`, `OPENAI_MODEL`ã€‚
- **`main.py`**:
  - æ•´åˆ `ai_engine` ç”Ÿå‘½é€±æœŸ (Startup/Shutdown)ã€‚
  - æ–°å¢ `/api/settings/ai` (GET/POST) ç”¨æ–¼å‰ç«¯å‹•æ…‹è¨­å®šã€‚

#### 3. å‰ç«¯ Web UI (Dashboard) ğŸ¨
- **Navbar**: æ–°å¢ã€ŒğŸ¤– AI è¨­å®šã€æŒ‰éˆ•ã€‚
- **Settings Modal**:
  - å•Ÿç”¨/åœç”¨é–‹é—œã€‚
  - API Key è¼¸å…¥æ¡† (æ”¯æ´å¯†ç¢¼æ©ç¢¼/ç•™ç©ºä¸ä¿®æ”¹)ã€‚
  - Base URL & Model è¨­å®šã€‚
  - ç‹€æ…‹é¡¯ç¤º (Running/Stopped)ã€‚
- **äº¤äº’é‚è¼¯**:
  - å³æ™‚å„²å­˜è¨­å®šä¸¦é‡å•Ÿå¾Œç«¯ AI å¼•æ“ã€‚
  - Toast é€šçŸ¥æ“ä½œçµæœã€‚

### ä¿®æ”¹æª”æ¡ˆæ¸…å–®
| æª”æ¡ˆ | æ”¹å‹•é¡å‹ |
| :--- | :--- |
| `backend/app/config.py` | æ–°å¢ AI ç›¸é—œé…ç½®åƒæ•¸ |
| `backend/app/llm/engine.py` | âœ¨ æ–°å¢ â€” å…§å»º AI è¼ªè©¢å¼•æ“ |
| `backend/app/main.py` | æ•´åˆ Engine ç”Ÿå‘½é€±æœŸèˆ‡ Settings API |
| `frontend/index.html` | æ–°å¢ AI è¨­å®šæŒ‰éˆ•èˆ‡ Modal |
| `frontend/js/app.js` | æ–°å¢ Modal æ§åˆ¶èˆ‡ API ä¸²æ¥é‚è¼¯ |

### ğŸ“¦ Git æäº¤è¨˜éŒ„ (Pending)
- `feat(phase3): implement internal AI engine with custom OpenAI API support`
- `feat(ui): add AI settings modal for dynamic configuration`

---

## ğŸ“… Session Log: 2026-02-19 22:46 ~ 22:57 (AI Engine Full Integration Test)

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
å°ä¸Šä¸€æ¬¡æ–°å¢çš„**å…§å»º AI å¼•æ“** (Internal AI Engine) åŠŸèƒ½é€²è¡Œå®Œæ•´æ€§åŸ·è¡Œæ¸¬è©¦ã€‚

### âœ… æ¸¬è©¦çµæœï¼šå…¨éƒ¨é€šé ğŸ‰

#### æ¸¬è©¦è…³æœ¬
- **æª”æ¡ˆ**: `backend/tests/test_ai_engine_full.py`
- **ç”¨æ³•**:
  - `python tests/test_ai_engine_full.py --unit` â€” åƒ…å–®å…ƒæ¸¬è©¦ï¼ˆä¸éœ€å¾Œç«¯ï¼‰
  - `python tests/test_ai_engine_full.py --api` â€” åƒ… API æ¸¬è©¦ï¼ˆéœ€å¾Œç«¯é‹è¡Œï¼‰
  - `python tests/test_ai_engine_full.py` â€” å…¨éƒ¨æ¸¬è©¦

#### æ¸¬è©¦é …ç›®èˆ‡çµæœ

| æ¸¬è©¦ç¾¤çµ„ | é …ç›®æ•¸ | çµæœ | èªªæ˜ |
|----------|--------|------|------|
| T1: Config è¨­å®šé©—è­‰ | 6/6 | âœ… | AI_MONITOR_*, OPENAI_* å…¨éƒ¨æ­£ç¢ºå®šç¾© |
| T2: AIEngine æ¨¡çµ„è¼‰å…¥ | 12/12 | âœ… | é¡åˆ¥ç¹¼æ‰¿ã€æ–¹æ³•å­˜åœ¨æ€§ã€å…§éƒ¨å±¬æ€§å…¨é€šé |
| T3: PromptBuilder å¿«ç…§ | 6/6 | âœ… | ä¸Šä¸‹æ–‡ç”Ÿæˆ + 4 ç¨® focus æ¨¡å¼ Prompt çš†æ­£ç¢º |
| T4: LLMAdvisor å»ºè­°è™•ç† | 13/13 | âœ… | æ ¼å¼é©—è­‰ã€æ¨¡å¼åˆ‡æ›ã€æ¬Šé‡èª¿æ•´ã€æŸ¥è©¢æ–¹æ³• |
| T5: E2E æ¨¡æ“¬ | 6/6 | âœ… | HOLD/SWITCH_MODE/PAUSE_TRADING/æ¬Šé‡èª¿æ•´ |
| T6: Engine ç”Ÿå‘½é€±æœŸ | 11/11 | âœ… | start/stopã€ç¼º key ä¿è­·ã€System Promptã€Mock API |
| T7: REST API ç«¯é» | 12/12 | âœ… | GET/POST /api/settings/aiã€/api/llm/* å…¨ç³»åˆ— |
| **ç¸½è¨ˆ** | **66/66** | **âœ…** | **0 å¤±æ•—** |

#### è©³ç´°æ¸¬è©¦å…§å®¹

##### T1: Config è¨­å®šé©—è­‰
- `AI_MONITOR_ENABLED`: bool, é è¨­ False (é€é env å•Ÿç”¨)
- `AI_MONITOR_INTERVAL`: int, é è¨­ 900s (15 åˆ†é˜)
- `OPENAI_API_KEY`: æ”¯æ´ env è¦†è“‹, æ©ç¢¼é¡¯ç¤º
- `OPENAI_BASE_URL`: é è¨­ `https://api.openai.com/v1`
- `OPENAI_MODEL`: é è¨­ `gpt-4-turbo`

##### T4: Advisor å»ºè­°è™•ç† (é‡é»)
- âœ… åˆæ³•å»ºè­° â†’ `status: received`
- âœ… ç„¡æ•ˆæ¨¡å¼ (`yolo_mode`) â†’ `status: rejected`
- âœ… ç¼ºå°‘å¿…è¦æ¬„ä½ â†’ `status: rejected`
- âœ… è¶…ç¯„åœ confidence (150) â†’ `status: rejected`
- âœ… ç„¡æ•ˆ action (`YOLO`) â†’ `status: rejected`
- âœ… æ¨¡å¼åˆ‡æ› â†’ `set_mode()` æ­£ç¢ºå‘¼å«
- âœ… æ¬Šé‡èª¿æ•´ â†’ é™åˆ¶åœ¨ 1-20 ç¯„åœ
- âœ… `get_last_advice()` / `get_stats()` æŸ¥è©¢æ­£å¸¸

##### T6: Engine ç”Ÿå‘½é€±æœŸ
- âœ… `AI_MONITOR_ENABLED=False` â†’ ä¸å•Ÿå‹•
- âœ… ç¼ºå°‘ `OPENAI_API_KEY` â†’ ä¸å•Ÿå‹•
- âœ… æœ‰æ•ˆ Key â†’ æˆåŠŸå•Ÿå‹•èƒŒæ™¯ä»»å‹™
- âœ… `stop()` â†’ æ­£ç¢ºå–æ¶ˆä»»å‹™
- âœ… System Prompt åŒ…å« JSON æ ¼å¼è¦æ±‚ã€äº¤æ˜“æ¨¡å¼é¸é …ã€BTC åˆ†ææŒ‡å¼•
- âœ… Markdown code block æ¸…ç†é‚è¼¯æ­£ç¢º

##### T7: REST API ç«¯é»
| API ç«¯é» | æ–¹æ³• | ç‹€æ…‹ |
|----------|------|------|
| `/api/settings/ai` | GET | âœ… 200 â€” å›å‚³ 6 æ¬„ä½ (enabled/api_key/base_url/model/interval/status) |
| `/api/settings/ai` | POST | âœ… 200 â€” æ›´æ–°è¨­å®š + å¼•æ“é‡å•Ÿ + é‚„åŸé©—è­‰ |
| `/api/settings/ai` | GET | âœ… API Key æ©ç¢¼ (`***xxxx`) å®‰å…¨é¡¯ç¤º |
| `/api/llm/context` | GET | âœ… 200 â€” çµæ§‹åŒ–ç³»çµ±å¿«ç…§å®Œæ•´ |
| `/api/llm/prompt` | GET | âœ… 200 â€” general/signal/risk ä¸‰ç¨® focus çš†æ­£ç¢º |
| `/api/llm/advice` | POST | âœ… 200 â€” å»ºè­°æ¥æ”¶æˆåŠŸ (auto_apply=False) |

### â³ å¾…å®Œæˆï¼šç€è¦½å™¨è¦–è¦ºæ¸¬è©¦
- **å‰ç«¯ AI è¨­å®š Modal** (`#modal-ai-settings`) çš„ UI äº¤äº’é©—è­‰å°šæœªå®Œæˆ
  - åŸå› ï¼šç•¶å‰ç’°å¢ƒ Playwright é…ç½® (`$HOME` ç’°å¢ƒè®Šæ•¸ç¼ºå¤±) å°è‡´ç„¡æ³•å•Ÿå‹•ç€è¦½å™¨
  - **HTML çµæ§‹å·²é©—è­‰**: `btn-ai-settings` æŒ‰éˆ• âœ…ã€`modal-ai-settings` Modal âœ… å‡å­˜åœ¨æ–¼ HTML ä¸­
  - **å¾…æ‰‹å‹•é©—è­‰é …ç›®**:
    1. é»æ“Šã€ŒğŸ¤– AI è¨­å®šã€æŒ‰éˆ• â†’ Modal é–‹å•Ÿ
    2. å•Ÿç”¨/åœç”¨é–‹é—œæ­£å¸¸åˆ‡æ›
    3. API Key å¯†ç¢¼è¼¸å…¥æ¡†åŠŸèƒ½
    4. Base URL / Model è¨­å®šæ›´æ–°
    5. å„²å­˜å¾Œ Toast é€šçŸ¥é¡¯ç¤º

### ä¿®æ”¹æª”æ¡ˆæ¸…å–®
| æª”æ¡ˆ | æ”¹å‹•é¡å‹ |
| :--- | :--- |
| `backend/tests/test_ai_engine_full.py` | âœ¨ æ–°å¢ â€” AI å¼•æ“å®Œæ•´æ€§æ¸¬è©¦ (7 é¡ 66 é …) |

---

## ğŸ“… Session Log: 2026-02-19 23:10 ~ 23:25 (UI Verification)

### ğŸ¯ æœ¬æ¬¡ Session ç›®æ¨™
å®Œæˆ Phase 3 å‰©é¤˜çš„ UI è¦–è¦ºé©—è­‰é …ç›®ï¼Œç¢ºèª AI è¨­å®š Modal åŠŸèƒ½æ­£å¸¸ã€‚

### âœ… å®Œæˆäº‹é …

#### 1. å‰ç«¯ UI è¦–è¦ºèˆ‡åŠŸèƒ½é©—è­‰
- **æ¸¬è©¦ç’°å¢ƒ**ï¼šå•Ÿå‹•å¾Œç«¯æœå‹™ (`python -m uvicorn app.main:app`)ï¼Œé€éç€è¦½å™¨è‡ªå‹•åŒ–å·¥å…·æ¨¡æ“¬ä½¿ç”¨è€…æ“ä½œã€‚
- **æ¸¬è©¦é …ç›®**ï¼š
  1. **Modal é–‹å•Ÿ**ï¼šé»æ“Š Navbar ä¸Šçš„ã€ŒğŸ¤– AI è¨­å®šã€æŒ‰éˆ•ï¼Œç¢ºèª Modal (`#modal-ai-settings`) æ­£ç¢ºå½ˆå‡ºã€‚
  2. **åƒæ•¸è¨­å®š**ï¼š
     - æˆåŠŸåˆ‡æ›ã€Œå•Ÿç”¨è‡ªå‹•ç›£æ§ã€é–‹é—œã€‚
     - æˆåŠŸè¼¸å…¥ä¸¦æ›´æ–° API Key (`test_key_123`)ã€‚
     - æˆåŠŸæ›´æ–° Base URL èˆ‡ Model åç¨±ã€‚
  3. **å„²å­˜åé¥‹**ï¼šé»æ“Šå„²å­˜å¾Œï¼Œç³»çµ±æ­£ç¢ºé¡¯ç¤º Toast é€šçŸ¥ï¼šã€Œâœ… AI ç›£æ§å·²å•Ÿå‹•: gpt-4-turbo-testã€ã€‚
- **çµè«–**ï¼šå‰ç«¯èˆ‡å¾Œç«¯ `/api/settings/ai` ä»‹æ¥æ­£å¸¸ï¼Œä½¿ç”¨è€…è¨­å®šæµç¨‹æš¢é€šã€‚

#### 2. å¾Œç«¯å¥åº·æª¢æŸ¥
- åŸ·è¡Œ `verify_health.py` ç¢ºèª `/api/cro/compact` ç«¯é»å›æ‡‰æ­£å¸¸ã€‚
- ç³»çµ±å›å‚³ç‹€æ…‹ï¼š
  - Mode: `balanced`
  - Spread: `5.16%`
  - Backend Status: `UP`

### ğŸ“ å‚™è¨»
- ç•¶å‰çš„ AI è¨­å®šåƒ…æ›´æ–°è¨˜æ†¶é«”ä¸­çš„ Config ç‰©ä»¶ï¼Œè‹¥å¾Œç«¯é‡å•Ÿæœƒé‚„åŸç‚ºé è¨­å€¼ï¼ˆç¬¦åˆç›®å‰çš„é–‹ç™¼éšæ®µè¨­è¨ˆï¼‰ã€‚
- é©—è­‰å®Œæˆå¾Œå·²é—œé–‰æ¸¬è©¦ç”¨çš„å¾Œç«¯é€²ç¨‹ã€‚

### ğŸ“¦ Git æäº¤è¨˜éŒ„ (Pending)
- `test(ui): verify AI settings modal interaction and API integration`

---

## ğŸ”® Phase 4: Hybrid Intelligence & Collaborative Architecture (Future)

### ğŸ¯ æ ¸å¿ƒæ¦‚å¿µï¼šä¸»é§•é§› (Driver) èˆ‡ å°èˆªå“¡ (Navigator)
å°‡ç³»çµ±æ¼”é€²ç‚ºã€Œäººæ©Ÿå”ä½œã€èˆ‡ã€Œè»Ÿç¡¬æŒ‡æ¨™èåˆã€çš„é›™å±¤æ¶æ§‹ã€‚

### ğŸ“… å¾…é–‹ç™¼è¨ˆç•«

#### 1. å°èˆªå“¡å±¤ç´šé¸å–® (Navigator Selection)
åœ¨ Dashboard è¨­å®šä¸­æä¾›ä¸‰ç¨® AI æˆ°ç•¥é¡§å•ä¾†æºï¼š
- ğŸ”˜ **OpenClaw (External)**: å®˜æ–¹ç¶­è­·çš„å®è§€åˆ†æå¤§è…¦ (Cloud Brain)ã€‚
- âšª **User Private AI (Internal)**: ä½¿ç”¨è€…è‡ªå‚™ API Key çš„å°ˆå±¬åˆ†æå¸« (User Brain)ã€‚
- âšª **None (Algo Only)**: ç´”æ•¸å­¸æ¼”ç®—æ³•ï¼Œç„¡ AI ä»‹å…¥ã€‚

#### 2. æ··åˆæ±ºç­–æ©Ÿåˆ¶ (Hybrid Decision Engine)
å¯¦ä½œã€ŒåŸºæœ¬é¢é©…å‹•æŠ€è¡“é¢ã€çš„åŠ æ¬Šé‚è¼¯ï¼š
- **Sentiment Factor**: å°èˆªå“¡ç”¢å‡ºå¸‚å ´æƒ…ç·’å› å­ (0.5~1.5)ã€‚
- **Signal Fusion**: Signal Generator å°‡æŠ€è¡“æŒ‡æ¨™åˆ†æ•¸ä¹˜ä¸Šæƒ…ç»ªå› å­ã€‚
  - *ç¯„ä¾‹*: æŠ€è¡“é¢è³£å‡º (-20) + åŸºæœ¬é¢å¤§åˆ©å¤š (x1.5) = è§€æœ›/å¾®å¹…è²·é€² (+10)ã€‚

#### 3. è¨±å¯æ¬Šé™ç®¡ç† (Authorization Mode)
å®šç¾©å°èˆªå“¡å°ä¸»é§•é§›çš„æ§åˆ¶æ¬Šé™ï¼š
- **AUTO (God Mode)**: AI å»ºè­°ç›´æ¥åŸ·è¡Œ (é©ç”¨æ–¼é«˜é »/å¤œé–“)ã€‚
- **HITL (Supervisor Mode)**: AI åƒ…èƒ½ã€Œææ¡ˆã€ï¼Œéœ€äººé¡åœ¨ Telegram/Dashboard æ‰¹å‡†ã€‚
- **MONITOR**: AI åƒ…æä¾›åˆ†æå ±å‘Šï¼Œä¸ä»‹å…¥æ“ä½œã€‚

#### 4. åŸºç¤è¨­æ–½å‡ç´š
- **Supervisor API**: `POST /api/supervisor/interact` (æ¥æ”¶æŒ‡ä»¤/ææ¡ˆ)ã€‚
- **Telegram Bot**: å¯¦ç¾ HITL çš„å³æ™‚é€šçŸ¥èˆ‡æŒ‰éˆ•æ ¸æ±ºåŠŸèƒ½ã€‚
- **Proposal Queue**: å¾Œç«¯æš«å­˜å¾…æ‰¹å‡†æŒ‡ä»¤çš„éšŠåˆ—ç³»çµ±ã€‚

### âœ… Phase 3 P2 Risk Management (v3.3.0) (2026-02-21)
- **åŸºç¤è¨­æ–½å‡ç´š**: å°‡å…¬ç”¨ RPC URL åˆ‡æ›è‡³æ›´ç©©å®šçš„ç§äºº dRPC ç«¯é» (Polygon)ã€‚
- **å FOMO äº¤æ˜“é‚è¼¯ (Anti-FOMO)**: åœ¨ `signal_generator.py` ä¸­åŠ å…¥äº†å°æ¥µç«¯ RSI å€åŸŸçš„ä¿è­·æ©Ÿåˆ¶ã€‚è‹¥ RSI > 75 ä»è¦ä½œå¤šï¼Œæˆ– RSI < 25 ä»è¦ä½œç©ºï¼Œä¿¡è™Ÿåˆ†æ•¸å°‡è¢«å¤§å¹…ç¸®æ¸› (ä¹˜ä»¥ 0.2)ã€‚
- **æœªå¯¦ç¾æç›Šæ•´åˆ**: 
  - `simulator.py` å¢å¼·äº† `get_stats()` æ–¹æ³•ï¼Œå°‡ç›®å‰çš„ Polymarket å³æ™‚å ±åƒ¹ (`pm_state`) å¸¶å…¥ï¼Œå³æ™‚çµç®—æ‰€æœ‰æœªå¹³å€‰å–®çš„**ã€Œæœªå¯¦ç¾æç›Šã€(Unrealized PnL)** å’Œ **ã€Œç¸½æ›éšªã€(Open Exposure)**ã€‚
  - å‰ç«¯ `index.html` èˆ‡ `app.js` æ–°å¢å…©å€‹æ¬„ä½ï¼Œåˆ†åˆ¥é«˜å…‰é¡¯ç¤ºæœªå¯¦ç¾æç›Šèˆ‡ç¸½æ›éšªï¼Œè®“ä½¿ç”¨è€…å¾ Dashboard å°±èƒ½æŒæ§é¢¨éšªã€‚
  - `test_v3_3_fomo_backtest.py` è…³æœ¬å·²ç¶“æ’°å¯«å®Œæˆï¼Œåœ¨æœ¬åœ°è³‡æ–™åº« `data/cheesedog_market_data_20260221.db` çš„å›æ¸¬ä¸­ï¼ŒæˆåŠŸç™¼æ®é˜»æ“‹äº†å¤šæ¬¡çš„ FOMO è¡Œç‚º (RSI = 93.9 / 7.0 ç­‰æ¥µç«¯ç‹€æ³çš†è¢«æ””æˆª)ã€‚

---

### ğŸ“… ä¸‹éšæ®µé–‹ç™¼è¨ˆç•« (Phase 5: Advanced Trading & Dynamic Rules)

#### è·¯ç·š Aï¼šé€ å¸‚å•†ç­–ç•¥æ“´å»º (Maker Strategy)
1. **Limit Orders**: ä¿®æ”¹ `simulator.py` èˆ‡ `backtester.py` çš„æ¶æ§‹ä¾†æ”¯æ´å§”è¨—æ›å–®ã€‚
2. **Order Book æ·±åº¦æ’®åˆ**: åœ¨æ¸¬è©¦ç’°å¢ƒ/æ¨¡æ“¬äº¤æ˜“ä¸­ï¼Œé€éè¨‚å–®ç°¿è¨ˆç®—é æœŸæ’éšŠæ™‚é–“èˆ‡æ·±åº¦ã€‚
3. **Spread æ”¶å‰²é‚è¼¯**: å¯¦ä½œæä¾›æµå‹•æ€§ (Liquidity Providing) çš„é›™é‚Šæ›å–®é‚è¼¯ï¼Œè³ºå–è²·è³£åƒ¹å·®ã€‚
4. **æ›éšªå°æ²–æ©Ÿåˆ¶**: é–‹ç™¼ä¿è­·å–®é‚Šæœªæˆäº¤é¢¨éšªçš„ Hedging æ–¹æ³•ã€‚

#### è·¯ç·š Bï¼šå‹•æ…‹æŒ‡æ¨™å¼•æ“ (Dynamic Rule Engine)
1. **Expression Parser**: é–‹ç™¼ä¸€å€‹é«˜åº¦éˆæ´»çš„é‹ç®—å¼è§£æå¼•æ“ï¼Œå–ä»£ç¾æœ‰çš„ç¡¬ç·¨ç¢¼äº¤æ˜“é‚è¼¯ã€‚
2. **é…ç½®åŒ–é©…å‹•**: å°‡æ ¸å¿ƒæŠ€è¡“æŒ‡æ¨™æ¬Šé‡ã€æ¢ä»¶ï¼Œè½‰ç§»è‡³å¯å‹•æ…‹æ›¿æ›çš„ JSON æˆ–é…ç½®æª”ã€‚
3. **AI Agent è‡ªè¨‚ API**: è³¦äºˆ AI ç›´æ¥èª¿æ•´æŒ‡æ¨™é–€æª»çš„æ¬Šé™ï¼ˆä¾‹å¦‚å‘¼å« API å°‡ RSI > 80 æ”¹ç‚º RSI > 85ï¼‰ã€‚
4. **é˜²å‘†æ²™ç›’ (Sandbox)**: ç¢ºä¿ AI ç”Ÿæˆçš„é‹ç®—å¼ä¸æœƒå°è‡´ç„¡é™è¿´åœˆæˆ–å ±éŒ¯ã€‚
